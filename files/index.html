<html><head><meta content="text/html; charset=UTF-8" http-equiv="content-type"><style type="text/css">@import url('https://themes.googleusercontent.com/fonts/css?kit=cGvuclDC_Z1vE_cnVEU6Ae_NZQ7StBcqH_vXVqoPMX0');.lst-kix_bfdbetehircx-1>li{counter-increment:lst-ctn-kix_bfdbetehircx-1}.lst-kix_ujw7041eqdy5-6>li{counter-increment:lst-ctn-kix_ujw7041eqdy5-6}.lst-kix_p3cseuv345mr-7>li{counter-increment:lst-ctn-kix_p3cseuv345mr-7}ol.lst-kix_bfdbetehircx-0.start{counter-reset:lst-ctn-kix_bfdbetehircx-0 0}.lst-kix_bfdbetehircx-0>li{counter-increment:lst-ctn-kix_bfdbetehircx-0}ul.lst-kix_77t63i9xjp3-4{list-style-type:none}ul.lst-kix_77t63i9xjp3-3{list-style-type:none}.lst-kix_ujw7041eqdy5-7>li{counter-increment:lst-ctn-kix_ujw7041eqdy5-7}ul.lst-kix_77t63i9xjp3-6{list-style-type:none}ol.lst-kix_bfdbetehircx-8.start{counter-reset:lst-ctn-kix_bfdbetehircx-8 0}ul.lst-kix_77t63i9xjp3-5{list-style-type:none}ul.lst-kix_77t63i9xjp3-8{list-style-type:none}ol.lst-kix_p3cseuv345mr-2.start{counter-reset:lst-ctn-kix_p3cseuv345mr-2 0}ul.lst-kix_77t63i9xjp3-7{list-style-type:none}ul.lst-kix_77t63i9xjp3-0{list-style-type:none}ul.lst-kix_77t63i9xjp3-2{list-style-type:none}ul.lst-kix_77t63i9xjp3-1{list-style-type:none}.lst-kix_bfdbetehircx-3>li{counter-increment:lst-ctn-kix_bfdbetehircx-3}ol.lst-kix_bfdbetehircx-5.start{counter-reset:lst-ctn-kix_bfdbetehircx-5 0}ol.lst-kix_ujw7041eqdy5-8.start{counter-reset:lst-ctn-kix_ujw7041eqdy5-8 0}ol.lst-kix_ujw7041eqdy5-2.start{counter-reset:lst-ctn-kix_ujw7041eqdy5-2 0}ol.lst-kix_bfdbetehircx-2.start{counter-reset:lst-ctn-kix_bfdbetehircx-2 0}.lst-kix_p3cseuv345mr-5>li{counter-increment:lst-ctn-kix_p3cseuv345mr-5}ol.lst-kix_ujw7041eqdy5-5.start{counter-reset:lst-ctn-kix_ujw7041eqdy5-5 0}.lst-kix_p3cseuv345mr-8>li{counter-increment:lst-ctn-kix_p3cseuv345mr-8}.lst-kix_p3cseuv345mr-8>li:before{content:"" counter(lst-ctn-kix_p3cseuv345mr-8,lower-roman) ". "}.lst-kix_bfdbetehircx-4>li{counter-increment:lst-ctn-kix_bfdbetehircx-4}ol.lst-kix_p3cseuv345mr-4.start{counter-reset:lst-ctn-kix_p3cseuv345mr-4 0}.lst-kix_77t63i9xjp3-1>li:before{content:"\0025cb  "}.lst-kix_p3cseuv345mr-6>li:before{content:"" counter(lst-ctn-kix_p3cseuv345mr-6,decimal) ". "}.lst-kix_p3cseuv345mr-7>li:before{content:"" counter(lst-ctn-kix_p3cseuv345mr-7,lower-latin) ". "}.lst-kix_77t63i9xjp3-2>li:before{content:"\0025a0  "}.lst-kix_p3cseuv345mr-4>li:before{content:"" counter(lst-ctn-kix_p3cseuv345mr-4,lower-latin) ". "}.lst-kix_77t63i9xjp3-3>li:before{content:"\0025cf  "}.lst-kix_77t63i9xjp3-5>li:before{content:"\0025a0  "}.lst-kix_p3cseuv345mr-4>li{counter-increment:lst-ctn-kix_p3cseuv345mr-4}.lst-kix_p3cseuv345mr-5>li:before{content:"" counter(lst-ctn-kix_p3cseuv345mr-5,lower-roman) ". "}.lst-kix_77t63i9xjp3-4>li:before{content:"\0025cb  "}.lst-kix_77t63i9xjp3-8>li:before{content:"\0025a0  "}.lst-kix_p3cseuv345mr-0>li:before{content:"" counter(lst-ctn-kix_p3cseuv345mr-0,decimal) ". "}.lst-kix_77t63i9xjp3-7>li:before{content:"\0025cb  "}.lst-kix_77t63i9xjp3-6>li:before{content:"\0025cf  "}.lst-kix_p3cseuv345mr-2>li:before{content:"" counter(lst-ctn-kix_p3cseuv345mr-2,lower-roman) ". "}ol.lst-kix_bfdbetehircx-6.start{counter-reset:lst-ctn-kix_bfdbetehircx-6 0}.lst-kix_p3cseuv345mr-3>li:before{content:"" counter(lst-ctn-kix_p3cseuv345mr-3,decimal) ". "}.lst-kix_p3cseuv345mr-1>li:before{content:"" counter(lst-ctn-kix_p3cseuv345mr-1,lower-latin) ". "}ol.lst-kix_bfdbetehircx-0{list-style-type:none}ol.lst-kix_p3cseuv345mr-5.start{counter-reset:lst-ctn-kix_p3cseuv345mr-5 0}ol.lst-kix_bfdbetehircx-1{list-style-type:none}ol.lst-kix_bfdbetehircx-2{list-style-type:none}ol.lst-kix_bfdbetehircx-3{list-style-type:none}ol.lst-kix_bfdbetehircx-4{list-style-type:none}ol.lst-kix_ujw7041eqdy5-3.start{counter-reset:lst-ctn-kix_ujw7041eqdy5-3 0}.lst-kix_p3cseuv345mr-1>li{counter-increment:lst-ctn-kix_p3cseuv345mr-1}ol.lst-kix_bfdbetehircx-7.start{counter-reset:lst-ctn-kix_bfdbetehircx-7 0}.lst-kix_ujw7041eqdy5-8>li{counter-increment:lst-ctn-kix_ujw7041eqdy5-8}ol.lst-kix_bfdbetehircx-5{list-style-type:none}ol.lst-kix_bfdbetehircx-6{list-style-type:none}ol.lst-kix_bfdbetehircx-7{list-style-type:none}.lst-kix_ujw7041eqdy5-5>li{counter-increment:lst-ctn-kix_ujw7041eqdy5-5}ol.lst-kix_bfdbetehircx-8{list-style-type:none}.lst-kix_ujw7041eqdy5-2>li{counter-increment:lst-ctn-kix_ujw7041eqdy5-2}.lst-kix_77t63i9xjp3-0>li:before{content:"\0025cb  "}ol.lst-kix_ujw7041eqdy5-4{list-style-type:none}ol.lst-kix_ujw7041eqdy5-3{list-style-type:none}ol.lst-kix_ujw7041eqdy5-6{list-style-type:none}.lst-kix_bfdbetehircx-7>li{counter-increment:lst-ctn-kix_bfdbetehircx-7}.lst-kix_ujw7041eqdy5-2>li:before{content:"" counter(lst-ctn-kix_ujw7041eqdy5-2,lower-roman) ". "}.lst-kix_ujw7041eqdy5-4>li:before{content:"" counter(lst-ctn-kix_ujw7041eqdy5-4,lower-latin) ". "}ol.lst-kix_ujw7041eqdy5-5{list-style-type:none}ol.lst-kix_ujw7041eqdy5-8{list-style-type:none}.lst-kix_bfdbetehircx-0>li:before{content:"" counter(lst-ctn-kix_bfdbetehircx-0,decimal) ". "}ol.lst-kix_ujw7041eqdy5-7{list-style-type:none}.lst-kix_ujw7041eqdy5-0>li{counter-increment:lst-ctn-kix_ujw7041eqdy5-0}.lst-kix_p3cseuv345mr-2>li{counter-increment:lst-ctn-kix_p3cseuv345mr-2}.lst-kix_ujw7041eqdy5-1>li:before{content:"" counter(lst-ctn-kix_ujw7041eqdy5-1,lower-latin) ". "}ol.lst-kix_ujw7041eqdy5-4.start{counter-reset:lst-ctn-kix_ujw7041eqdy5-4 0}.lst-kix_ujw7041eqdy5-5>li:before{content:"" counter(lst-ctn-kix_ujw7041eqdy5-5,lower-roman) ". "}ol.lst-kix_bfdbetehircx-4.start{counter-reset:lst-ctn-kix_bfdbetehircx-4 0}.lst-kix_bfdbetehircx-2>li:before{content:"" counter(lst-ctn-kix_bfdbetehircx-2,lower-roman) ". "}.lst-kix_bfdbetehircx-1>li:before{content:"" counter(lst-ctn-kix_bfdbetehircx-1,lower-latin) ". "}.lst-kix_ujw7041eqdy5-0>li:before{content:"" counter(lst-ctn-kix_ujw7041eqdy5-0,upper-latin) ". "}.lst-kix_ujw7041eqdy5-6>li:before{content:"" counter(lst-ctn-kix_ujw7041eqdy5-6,decimal) ". "}.lst-kix_ujw7041eqdy5-8>li:before{content:"" counter(lst-ctn-kix_ujw7041eqdy5-8,lower-roman) ". "}ol.lst-kix_ujw7041eqdy5-0{list-style-type:none}ol.lst-kix_ujw7041eqdy5-2{list-style-type:none}ol.lst-kix_ujw7041eqdy5-1{list-style-type:none}.lst-kix_ujw7041eqdy5-7>li:before{content:"" counter(lst-ctn-kix_ujw7041eqdy5-7,lower-latin) ". "}ol.lst-kix_bfdbetehircx-1.start{counter-reset:lst-ctn-kix_bfdbetehircx-1 0}.lst-kix_bfdbetehircx-5>li:before{content:"" counter(lst-ctn-kix_bfdbetehircx-5,lower-roman) ". "}.lst-kix_bfdbetehircx-6>li:before{content:"" counter(lst-ctn-kix_bfdbetehircx-6,decimal) ". "}ol.lst-kix_ujw7041eqdy5-1.start{counter-reset:lst-ctn-kix_ujw7041eqdy5-1 0}.lst-kix_ujw7041eqdy5-1>li{counter-increment:lst-ctn-kix_ujw7041eqdy5-1}.lst-kix_bfdbetehircx-3>li:before{content:"" counter(lst-ctn-kix_bfdbetehircx-3,decimal) ". "}.lst-kix_bfdbetehircx-4>li:before{content:"" counter(lst-ctn-kix_bfdbetehircx-4,lower-latin) ". "}.lst-kix_bfdbetehircx-7>li:before{content:"" counter(lst-ctn-kix_bfdbetehircx-7,lower-latin) ". "}.lst-kix_bfdbetehircx-8>li:before{content:"" counter(lst-ctn-kix_bfdbetehircx-8,lower-roman) ". "}.lst-kix_p3cseuv345mr-3>li{counter-increment:lst-ctn-kix_p3cseuv345mr-3}.lst-kix_ujw7041eqdy5-3>li:before{content:"" counter(lst-ctn-kix_ujw7041eqdy5-3,decimal) ". "}.lst-kix_bfdbetehircx-6>li{counter-increment:lst-ctn-kix_bfdbetehircx-6}ol.lst-kix_p3cseuv345mr-0.start{counter-reset:lst-ctn-kix_p3cseuv345mr-0 0}ol.lst-kix_p3cseuv345mr-3.start{counter-reset:lst-ctn-kix_p3cseuv345mr-3 0}ol.lst-kix_p3cseuv345mr-6.start{counter-reset:lst-ctn-kix_p3cseuv345mr-6 0}.lst-kix_ujw7041eqdy5-3>li{counter-increment:lst-ctn-kix_ujw7041eqdy5-3}ol.lst-kix_p3cseuv345mr-4{list-style-type:none}ol.lst-kix_p3cseuv345mr-3{list-style-type:none}ol.lst-kix_p3cseuv345mr-2{list-style-type:none}ol.lst-kix_p3cseuv345mr-7.start{counter-reset:lst-ctn-kix_p3cseuv345mr-7 0}ol.lst-kix_p3cseuv345mr-1{list-style-type:none}ol.lst-kix_p3cseuv345mr-8{list-style-type:none}ol.lst-kix_p3cseuv345mr-7{list-style-type:none}ol.lst-kix_p3cseuv345mr-6{list-style-type:none}.lst-kix_ujw7041eqdy5-4>li{counter-increment:lst-ctn-kix_ujw7041eqdy5-4}ol.lst-kix_p3cseuv345mr-5{list-style-type:none}ol.lst-kix_ujw7041eqdy5-6.start{counter-reset:lst-ctn-kix_ujw7041eqdy5-6 0}ol.lst-kix_bfdbetehircx-3.start{counter-reset:lst-ctn-kix_bfdbetehircx-3 0}.lst-kix_p3cseuv345mr-0>li{counter-increment:lst-ctn-kix_p3cseuv345mr-0}.lst-kix_p3cseuv345mr-6>li{counter-increment:lst-ctn-kix_p3cseuv345mr-6}.lst-kix_bfdbetehircx-8>li{counter-increment:lst-ctn-kix_bfdbetehircx-8}ol.lst-kix_p3cseuv345mr-0{list-style-type:none}ol.lst-kix_ujw7041eqdy5-7.start{counter-reset:lst-ctn-kix_ujw7041eqdy5-7 0}li.li-bullet-0:before{margin-left:-18pt;white-space:nowrap;display:inline-block;min-width:18pt}ol.lst-kix_p3cseuv345mr-8.start{counter-reset:lst-ctn-kix_p3cseuv345mr-8 0}ol.lst-kix_p3cseuv345mr-1.start{counter-reset:lst-ctn-kix_p3cseuv345mr-1 0}ol.lst-kix_ujw7041eqdy5-0.start{counter-reset:lst-ctn-kix_ujw7041eqdy5-0 0}.lst-kix_bfdbetehircx-5>li{counter-increment:lst-ctn-kix_bfdbetehircx-5}.lst-kix_bfdbetehircx-2>li{counter-increment:lst-ctn-kix_bfdbetehircx-2}ol{margin:0;padding:0}table td,table th{padding:0}.c25{border-right-style:solid;padding:5pt 5pt 5pt 5pt;border-bottom-color:#000000;border-top-width:0pt;border-right-width:0pt;border-left-color:#000000;vertical-align:top;border-right-color:#000000;border-left-width:0pt;border-top-style:solid;background-color:#f8f8f8;border-left-style:solid;border-bottom-width:0pt;width:451.3pt;border-top-color:#000000;border-bottom-style:solid}.c22{margin-left:48pt;padding-top:24pt;padding-bottom:0pt;line-height:1.15;orphans:2;widows:2;text-align:left}.c30{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:"Arial";font-style:normal}.c28{padding-top:0pt;padding-bottom:16pt;line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}.c0{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:11pt;font-family:"Arial";font-style:normal}.c5{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:16pt;font-family:"Arial";font-style:normal}.c34{color:#666666;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:15pt;font-family:"Arial";font-style:normal}.c16{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:26pt;font-family:"Arial";font-style:normal}.c18{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:10.5pt;font-family:"Verdana";font-style:normal}.c20{padding-top:18pt;padding-bottom:6pt;line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}.c24{padding-top:0pt;padding-bottom:3pt;line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}.c27{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:12pt;font-family:"Consolas";font-style:normal}.c3{padding-top:0pt;padding-bottom:0pt;line-height:1.15;orphans:2;widows:2;text-align:left}.c23{background-color:#f8f8f8;font-family:"Consolas";font-style:italic;color:#999988;font-weight:400}.c21{background-color:#f8f8f8;font-family:"Consolas";color:#990000;font-weight:700}.c6{text-decoration:none;vertical-align:baseline;font-size:11pt;font-style:normal}.c4{background-color:#f8f8f8;font-family:"Consolas";color:#008080;font-weight:400}.c32{padding-top:0pt;padding-bottom:0pt;line-height:1.15;text-align:left}.c2{background-color:#f8f8f8;font-family:"Consolas";color:#333333;font-weight:700}.c17{text-decoration-skip-ink:none;-webkit-text-decoration-skip:none;color:#1155cc;text-decoration:underline}.c8{background-color:#f8f8f8;font-family:"Consolas";color:#990073;font-weight:400}.c19{border-spacing:0;border-collapse:collapse;margin-right:auto}.c33{background-color:#f8f8f8;font-family:"Consolas";color:#dd1144;font-weight:400}.c1{background-color:#f8f8f8;font-family:"Consolas";color:#333333;font-weight:400}.c29{font-size:12pt;font-family:"Consolas";font-weight:400}.c35{font-size:10.5pt;font-family:"Verdana";font-weight:400}.c26{font-size:12pt;font-family:"Georgia";font-weight:400}.c31{background-color:#ffffff;max-width:451.3pt;padding:72pt 72pt 72pt 72pt}.c11{color:inherit;text-decoration:inherit}.c7{margin-left:72pt;padding-left:0pt}.c14{padding:0;margin:0}.c15{height:0pt}.c9{height:11pt}.c10{margin-left:36pt}.c12{text-indent:36pt}.c13{padding-left:0pt}.title{padding-top:0pt;color:#000000;font-size:26pt;padding-bottom:3pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}.subtitle{padding-top:0pt;color:#666666;font-size:15pt;padding-bottom:16pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}li{color:#000000;font-size:11pt;font-family:"Arial"}p{margin:0;color:#000000;font-size:11pt;font-family:"Arial"}h1{padding-top:20pt;color:#000000;font-size:20pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h2{padding-top:18pt;color:#000000;font-size:16pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h3{padding-top:16pt;color:#434343;font-size:14pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h4{padding-top:14pt;color:#666666;font-size:12pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h5{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h6{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;font-style:italic;orphans:2;widows:2;text-align:left}</style></head><body class="c31"><p class="c24 title" id="h.l9lk91veaq21"><span class="c16">CMPT 489/980 Project</span></p><p class="c28 subtitle" id="h.ghddf3eps8a3"><span class="c34">LLVM IR Pass: SIMD Within a Register (SWAR)</span></p><p class="c3"><span class="c0">Hao (Cole) Wu, Anend Yan</span></p><h2 class="c20" id="h.ts9bl0n28z3r"><span class="c5">Introduction</span></h2><p class="c3"><span class="c0">Today, almost all instruction sets support SIMD operation for common vectors like i8, i16 and i32. However, support for arbitrary vectors is still lacking. For example, a vector in the form of &lt;16 x i4&gt; represents 16 numbers each containing 4 bits, which is 64 bits totally. Due to the fact that most instruction sets which do not directly support i4, the LLVM backend will produce massive code to generate corresponding machine code to complete the task, which typically wastes a big portion of resources.</span></p><p class="c3 c9"><span class="c0"></span></p><p class="c3"><span class="c0">The goal of our project is to &ldquo;SWARize&rdquo; some of these arbitrary vectors&rsquo; operations--i.e. Increasing efficiency of these operations by performing SIMD within the oddball register. To increase the efficiency, we can take advantage of partitioning registers into small, multiple fields that can be operated on in parallel.</span></p><h2 class="c20" id="h.lripsp2hknd8"><span class="c5">Relative work and background</span></h2><ol class="c14 lst-kix_p3cseuv345mr-0 start" start="1"><li class="c3 c10 c13 li-bullet-0"><span class="c0">Run SIMD within conventional microprocessors.</span></li></ol><p class="c3 c10"><span class="c0">Run SIMD on general purpose register.</span></p><p class="c3 c10"><span class="c0">Aim to enhance multimedia operations.</span></p><ol class="c14 lst-kix_p3cseuv345mr-0" start="2"><li class="c3 c10 c13 li-bullet-0"><span class="c0">Swar in LLVM</span></li></ol><p class="c3"><span class="c0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;We found reports on LLVM bugzilla about potential improvement of Swar-like code.</span></p><p class="c3 c12"><span>Although there is no systematic structure for Swar support in LLVM.</span></p><p class="c3 c9"><span class="c0"></span></p><h2 class="c20" id="h.sp3apz3ra8fz"><span class="c5">SWAR Operations</span></h2><ol class="c14 lst-kix_bfdbetehircx-0 start" start="1"><li class="c3 c10 c13 li-bullet-0"><span class="c0">Polymorphic Operation</span></li></ol><p class="c3 c10"><span class="c0">SWAR operations that can be performed without concern if the field is partitioned. For example, AND, NOT, OR and XOR are polymorphic operations since the result of these functions are independent of field sizes.</span></p><ol class="c14 lst-kix_bfdbetehircx-0" start="2"><li class="c3 c10 c13 li-bullet-0"><span class="c0">Partitioned Operation</span></li></ol><p class="c3 c10"><span class="c0">Since lots of operations are not polymorphic such as Add, Subtract and Multiply, the result like carry will affect adjacent fields. In this case, we need partitioned operations to partition the operands and result to prevent interactions between fields.</span></p><ol class="c14 lst-kix_bfdbetehircx-0" start="3"><li class="c3 c10 c13 li-bullet-0"><span class="c0">Reduction Operation</span></li></ol><p class="c3 c10"><span class="c0">Operations that recursively combine field values into a single value.</span></p><p class="c3 c9"><span class="c5"></span></p><h2 class="c20" id="h.p3dali7u1zq1"><span class="c5">Example</span></h2><p class="c3"><span class="c0">For partition operation:</span></p><a id="t.0527139013499802021c6569620bbd86d994ba2f"></a><a id="t.0"></a><table class="c19"><tbody><tr class="c15"><td class="c25" colspan="1" rowspan="1"><p class="c32"><span class="c21">@.str</span><span class="c1">&nbsp;= </span><span class="c2">private</span><span class="c1">&nbsp;</span><span class="c2">constant</span><span class="c1">&nbsp;[</span><span class="c4">26</span><span class="c1">&nbsp;</span><span class="c2">x</span><span class="c1">&nbsp;</span><span class="c2">i8</span><span class="c1">] </span><span class="c2">c</span><span class="c33">&quot;&lt;4 x i3&gt;&lt;%i, %i, %i, %i&gt;\0A\00&quot;</span><span class="c1">, </span><span class="c2">align</span><span class="c1">&nbsp;</span><span class="c4">1</span><span class="c1"><br></span><span class="c2">declare</span><span class="c1">&nbsp;</span><span class="c2">i32</span><span class="c1">&nbsp;</span><span class="c21">@printf</span><span class="c1">(</span><span class="c2">i8</span><span class="c1">*, ...)<br><br></span><span class="c21">@vec1</span><span class="c1">&nbsp;= </span><span class="c2">constant</span><span class="c1">&nbsp;&lt;</span><span class="c4">4</span><span class="c1">&nbsp;</span><span class="c2">x</span><span class="c1">&nbsp;</span><span class="c2">i3</span><span class="c1">&gt; &lt;</span><span class="c2">i3</span><span class="c1">&nbsp;</span><span class="c4">1</span><span class="c1">, </span><span class="c2">i3</span><span class="c1">&nbsp;</span><span class="c4">2</span><span class="c1">, </span><span class="c2">i3</span><span class="c1">&nbsp;</span><span class="c4">3</span><span class="c1">, </span><span class="c2">i3</span><span class="c1">&nbsp;</span><span class="c4">3</span><span class="c1">&gt; </span><span class="c23">; 001 010 011 011<br></span><span class="c21">@vec2</span><span class="c1">&nbsp;= </span><span class="c2">constant</span><span class="c1">&nbsp;&lt;</span><span class="c4">4</span><span class="c1">&nbsp;</span><span class="c2">x</span><span class="c1">&nbsp;</span><span class="c2">i3</span><span class="c1">&gt; &lt;</span><span class="c2">i3</span><span class="c1">&nbsp;</span><span class="c4">5</span><span class="c1">, </span><span class="c2">i3</span><span class="c1">&nbsp;</span><span class="c4">1</span><span class="c1">, </span><span class="c2">i3</span><span class="c1">&nbsp;</span><span class="c4">1</span><span class="c1">, </span><span class="c2">i3</span><span class="c1">&nbsp;</span><span class="c4">3</span><span class="c1">&gt; </span><span class="c23">; 101 001 001 011<br></span><span class="c1"><br></span><span class="c2">define</span><span class="c1">&nbsp;</span><span class="c2">i16</span><span class="c1">&nbsp;</span><span class="c21">@main</span><span class="c1">() {<br> </span><span class="c8">%v1</span><span class="c1">&nbsp;= </span><span class="c2">load</span><span class="c1">&nbsp;&lt;</span><span class="c4">4</span><span class="c1">&nbsp;</span><span class="c2">x</span><span class="c1">&nbsp;</span><span class="c2">i3</span><span class="c1">&gt;, &lt;</span><span class="c4">4</span><span class="c1">&nbsp;</span><span class="c2">x</span><span class="c1">&nbsp;</span><span class="c2">i3</span><span class="c1">&gt;* </span><span class="c21">@vec1</span><span class="c1"><br> </span><span class="c8">%v2</span><span class="c1">&nbsp;= </span><span class="c2">load</span><span class="c1">&nbsp;&lt;</span><span class="c4">4</span><span class="c1">&nbsp;</span><span class="c2">x</span><span class="c1">&nbsp;</span><span class="c2">i3</span><span class="c1">&gt;, &lt;</span><span class="c4">4</span><span class="c1">&nbsp;</span><span class="c2">x</span><span class="c1">&nbsp;</span><span class="c2">i3</span><span class="c1">&gt;* </span><span class="c21">@vec2</span><span class="c1"><br> </span><span class="c8">%x1</span><span class="c1">&nbsp;= </span><span class="c2">bitcast</span><span class="c1">&nbsp;&lt;</span><span class="c4">4</span><span class="c1">&nbsp;</span><span class="c2">x</span><span class="c1">&nbsp;</span><span class="c2">i3</span><span class="c1">&gt; </span><span class="c8">%v1</span><span class="c1">&nbsp;</span><span class="c2">to</span><span class="c1">&nbsp;</span><span class="c2">i12</span><span class="c1"><br> </span><span class="c8">%x2</span><span class="c1">&nbsp;= </span><span class="c2">bitcast</span><span class="c1">&nbsp;&lt;</span><span class="c4">4</span><span class="c1">&nbsp;</span><span class="c2">x</span><span class="c1">&nbsp;</span><span class="c2">i3</span><span class="c1">&gt; </span><span class="c8">%v2</span><span class="c1">&nbsp;</span><span class="c2">to</span><span class="c1">&nbsp;</span><span class="c2">i12</span><span class="c1"><br><br> </span><span class="c8">%m1</span><span class="c1">&nbsp;= </span><span class="c2">and</span><span class="c1">&nbsp;</span><span class="c2">i12</span><span class="c1">&nbsp;</span><span class="c8">%x1</span><span class="c1">, </span><span class="c4">1755</span><span class="c1">&nbsp;</span><span class="c23">;mask 011011011011 to filter out higher bit<br></span><span class="c1">&nbsp;</span><span class="c8">%m2</span><span class="c1">&nbsp;= </span><span class="c2">and</span><span class="c1">&nbsp;</span><span class="c2">i12</span><span class="c1">&nbsp;</span><span class="c8">%x2</span><span class="c1">, </span><span class="c4">1755</span><span class="c1"><br> </span><span class="c8">%r1</span><span class="c1">&nbsp;= </span><span class="c2">add</span><span class="c1">&nbsp;</span><span class="c2">i12</span><span class="c1">&nbsp;</span><span class="c8">%m1</span><span class="c1">, </span><span class="c8">%m2</span><span class="c1"><br> </span><span class="c8">%r2</span><span class="c1">&nbsp;= </span><span class="c2">xor</span><span class="c1">&nbsp;</span><span class="c2">i12</span><span class="c1">&nbsp;</span><span class="c8">%x1</span><span class="c1">, </span><span class="c8">%x2</span><span class="c1"><br> </span><span class="c8">%r3</span><span class="c1">&nbsp;= </span><span class="c2">and</span><span class="c1">&nbsp;</span><span class="c2">i12</span><span class="c1">&nbsp;</span><span class="c8">%r2</span><span class="c1">, </span><span class="c4">2340</span><span class="c1">&nbsp;</span><span class="c23">;mask 100100100100 to filter out lower bits<br></span><span class="c1">&nbsp;</span><span class="c8">%r4</span><span class="c1">&nbsp;= </span><span class="c2">xor</span><span class="c1">&nbsp;</span><span class="c2">i12</span><span class="c1">&nbsp;</span><span class="c8">%r1</span><span class="c1">, </span><span class="c8">%r3</span><span class="c1"><br><br> </span><span class="c8">%a</span><span class="c1">&nbsp;= </span><span class="c2">bitcast</span><span class="c1">&nbsp;</span><span class="c2">i12</span><span class="c1">&nbsp;</span><span class="c8">%r4</span><span class="c1">&nbsp;</span><span class="c2">to</span><span class="c1">&nbsp;&lt;</span><span class="c4">4</span><span class="c1">&nbsp;</span><span class="c2">x</span><span class="c1">&nbsp;</span><span class="c2">i3</span><span class="c1">&gt;<br> </span><span class="c8">%a0</span><span class="c1">&nbsp;= </span><span class="c2">extractelement</span><span class="c1">&nbsp;&lt;</span><span class="c4">4</span><span class="c1">&nbsp;</span><span class="c2">x</span><span class="c1">&nbsp;</span><span class="c2">i3</span><span class="c1">&gt; </span><span class="c8">%a</span><span class="c1">, </span><span class="c2">i32</span><span class="c1">&nbsp;</span><span class="c4">0</span><span class="c1"><br> </span><span class="c8">%a1</span><span class="c1">&nbsp;= </span><span class="c2">extractelement</span><span class="c1">&nbsp;&lt;</span><span class="c4">4</span><span class="c1">&nbsp;</span><span class="c2">x</span><span class="c1">&nbsp;</span><span class="c2">i3</span><span class="c1">&gt; </span><span class="c8">%a</span><span class="c1">, </span><span class="c2">i32</span><span class="c1">&nbsp;</span><span class="c4">1</span><span class="c1"><br> </span><span class="c8">%a2</span><span class="c1">&nbsp;= </span><span class="c2">extractelement</span><span class="c1">&nbsp;&lt;</span><span class="c4">4</span><span class="c1">&nbsp;</span><span class="c2">x</span><span class="c1">&nbsp;</span><span class="c2">i3</span><span class="c1">&gt; </span><span class="c8">%a</span><span class="c1">, </span><span class="c2">i32</span><span class="c1">&nbsp;</span><span class="c4">2</span><span class="c1"><br> </span><span class="c8">%a3</span><span class="c1">&nbsp;= </span><span class="c2">extractelement</span><span class="c1">&nbsp;&lt;</span><span class="c4">4</span><span class="c1">&nbsp;</span><span class="c2">x</span><span class="c1">&nbsp;</span><span class="c2">i3</span><span class="c1">&gt; </span><span class="c8">%a</span><span class="c1">, </span><span class="c2">i32</span><span class="c1">&nbsp;</span><span class="c4">3</span><span class="c1"><br> </span><span class="c8">%1</span><span class="c1">&nbsp;= </span><span class="c2">call</span><span class="c1">&nbsp;</span><span class="c2">i32</span><span class="c1">&nbsp;(</span><span class="c2">i8</span><span class="c1">*, ...) </span><span class="c21">@printf</span><span class="c1">(</span><span class="c2">i8</span><span class="c1">* </span><span class="c2">getelementptr</span><span class="c1">&nbsp;</span><span class="c2">inbounds</span><span class="c1">&nbsp;([</span><span class="c4">26</span><span class="c1">&nbsp;</span><span class="c2">x</span><span class="c1">&nbsp;</span><span class="c2">i8</span><span class="c1">], [</span><span class="c4">26</span><span class="c1">&nbsp;</span><span class="c2">x</span><span class="c1">&nbsp;</span><span class="c2">i8</span><span class="c1">]* </span><span class="c21">@.str</span><span class="c1">, </span><span class="c2">i32</span><span class="c1">&nbsp;</span><span class="c4">0</span><span class="c1">, </span><span class="c2">i32</span><span class="c1">&nbsp;</span><span class="c4">0</span><span class="c1">), </span><span class="c2">i3</span><span class="c1">&nbsp;</span><span class="c8">%a0</span><span class="c1">, </span><span class="c2">i3</span><span class="c1">&nbsp;</span><span class="c8">%a1</span><span class="c1">, </span><span class="c2">i3</span><span class="c1">&nbsp;</span><span class="c8">%a2</span><span class="c1">, </span><span class="c2">i3</span><span class="c1">&nbsp;</span><span class="c8">%a3</span><span class="c1">)<br> </span><span class="c2">ret</span><span class="c1">&nbsp;</span><span class="c2">i16</span><span class="c1">&nbsp;</span><span class="c4">0</span><span class="c1 c6"><br>}</span></p></td></tr></tbody></table><p class="c3 c9"><span class="c0"></span></p><h2 class="c20" id="h.ezdnz3yub1t"><span class="c5">Goal</span></h2><p class="c3"><span class="c0">Implement following instruction:</span></p><p class="c3 c9"><span class="c18"></span></p><ol class="c14 lst-kix_ujw7041eqdy5-0 start" start="1"><li class="c3 c10 c13 li-bullet-0"><span class="c18">Binary</span></li></ol><ol class="c14 lst-kix_ujw7041eqdy5-1 start" start="1"><li class="c3 c7 li-bullet-0"><span class="c18">Add</span></li><li class="c3 c7 li-bullet-0"><span class="c18">Sub</span></li><li class="c3 c7 li-bullet-0"><span class="c18">Mul</span></li><li class="c3 c7 li-bullet-0"><span class="c18">Udiv</span></li><li class="c3 c7 li-bullet-0"><span class="c18">Urem</span></li></ol><ol class="c14 lst-kix_ujw7041eqdy5-0" start="2"><li class="c3 c10 c13 li-bullet-0"><span class="c18">Vector</span></li></ol><ol class="c14 lst-kix_ujw7041eqdy5-1 start" start="1"><li class="c3 c7 li-bullet-0"><span class="c18">Extractelement</span></li><li class="c3 c7 li-bullet-0"><span class="c18">Insertelement</span></li><li class="c3 c7 li-bullet-0"><span class="c18">Shufflevector</span></li></ol><ol class="c14 lst-kix_ujw7041eqdy5-0" start="3"><li class="c3 c10 c13 li-bullet-0"><span class="c18">Conversion</span></li></ol><ol class="c14 lst-kix_ujw7041eqdy5-1 start" start="1"><li class="c3 c7 li-bullet-0"><span class="c18">Trunc .. to</span></li><li class="c3 c7 li-bullet-0"><span class="c18">Zext .. to</span></li></ol><ol class="c14 lst-kix_ujw7041eqdy5-0" start="4"><li class="c3 c10 c13 li-bullet-0"><span class="c18">Other</span></li></ol><ol class="c14 lst-kix_ujw7041eqdy5-1 start" start="1"><li class="c3 c7 li-bullet-0"><span class="c18">Icmp</span></li><li class="c3 c7 li-bullet-0"><span class="c18">select</span></li></ol><p class="c3"><span class="c18">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&hellip;&hellip;.</span></p><p class="c3 c9"><span class="c0"></span></p><p class="c3"><span class="c0">For following type:</span></p><ul class="c14 lst-kix_77t63i9xjp3-0 start"><li class="c22 c13 li-bullet-0"><span class="c26">128-bit SIMD &nbsp;</span><span class="c29">&lt;32 x i4&gt;</span><span class="c26">, </span><span class="c29">&lt;64 x i2&gt;</span><span class="c26">, </span><span class="c27">&lt;128 x i1&gt;</span></li><li class="c13 c22 li-bullet-0"><span class="c26">256-bit SIMD &nbsp;</span><span class="c29">&lt;64 x i4&gt;</span><span class="c26">, </span><span class="c29">&lt;128 x i2&gt;</span><span class="c26">, </span><span class="c27">&lt;256 x i1&gt;</span></li></ul><p class="c3 c9"><span class="c0"></span></p><p class="c3 c9"><span class="c0"></span></p><h2 class="c20" id="h.8oqmt8cinq7i"><span class="c5">Method</span></h2><p class="c3"><span class="c0">We will start with writing the above instruction by hand, then try to find a pattern and generalize our code.</span></p><h2 class="c20" id="h.aik6htcrxvke"><span class="c5">Evaluation </span></h2><p class="c3"><span class="c35">Writing correctness test for above type and </span><span>instruction.</span></p><h2 class="c20" id="h.cowbeqcbt6ep"><span class="c5">Resources</span></h2><p class="c3"><span class="c17"><a class="c11" href="https://www.google.com/url?q=https://llvm.org/docs/LangRef.html&amp;sa=D&amp;source=editors&amp;ust=1624043028215000&amp;usg=AOvVaw0D2rOLIZ-fyNbNxfftktZt">https://llvm.org/docs/LangRef.html</a></span></p><p class="c3 c9"><span class="c0"></span></p><p class="c3"><span class="c0">Fisher, R. J, &amp; Dietz, H. G. (1999). Compiling for SIMD Within a register. Lecture Notes in Computer Science, 290&ndash;304.</span></p><p class="c3 c9"><span class="c0"></span></p><p class="c3"><span class="c17"><a class="c11" href="https://www.google.com/url?q=https://bugs.llvm.org/buglist.cgi?quicksearch%3Dswar&amp;sa=D&amp;source=editors&amp;ust=1624043028216000&amp;usg=AOvVaw3JckdjXS-y_kplXmjXjIyI">https://bugs.llvm.org/buglist.cgi?quicksearch=swar</a></span></p><p class="c3 c9"><span class="c0"></span></p><p class="c3"><span class="c17"><a class="c11" href="https://www.google.com/url?q=https://tldp.org/HOWTO/Parallel-Processing-HOWTO-4.html&amp;sa=D&amp;source=editors&amp;ust=1624043028216000&amp;usg=AOvVaw0APoWmoNDkFyv1izfMJWoE">https://tldp.org/HOWTO/Parallel-Processing-HOWTO-4.html</a></span></p><p class="c3 c9"><span class="c0"></span></p></body></html>
